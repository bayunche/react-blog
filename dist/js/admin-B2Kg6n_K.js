const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/react-vendor-DCjvIuTI.js","assets/react-vendor-DOnzI3fN.css","js/public-components-C6eUVMn5.js","assets/public-components-1-l67Qvh.css"])))=>i.map(i=>d[i]);
import{c as e,s as t,p as a,a as s,m as n,b as l,i as r,P as i,j as o,d as c,r as d,R as u,e as m,f as h,g,h as p,k as f,L as x,T as y,l as j,F as b,I as v,S,n as C,B as w,o as k,q as T,t as A,u as N,M as _,v as L,w as I,x as E,y as D,z as O,A as P,C as z,D as F,E as M,G as B,H as R,J as q,K as U,N as Y,O as $,Q as J,U as K,V,W as G,X as H,Y as W,Z as Q,_ as Z,$ as X,a0 as ee,a1 as te,a2 as ae,a3 as se,a4 as ne,a5 as le}from"./react-vendor-DCjvIuTI.js";import{M as re}from"./web-CmMoU9EY.js";const ie={},oe=function(e,t,a){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),a=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in ie)return;ie[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(e,'"]').concat(s)))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,a&&n.setAttribute("nonce",a),document.head.appendChild(n),t?new Promise((t,a)=>{n.addEventListener("load",t),n.addEventListener("error",()=>a(new Error("Unable to preload CSS for ".concat(e))))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})},ce=e=>{const t=localStorage.getItem(e);return t?0===t.indexOf("{")||0===t.indexOf("[")?JSON.parse(t):t:null},de=(e,t)=>{const a="object"==typeof t?JSON.stringify(t):t;localStorage.setItem(e,a)},ue=e(t(a((e,t)=>({username:"",role:2,userId:0,github:null,email:null,token:null,avatar:null,bio:null,isAuthenticated:!1,loginTime:null,lastActiveTime:null,loading:!1,error:null,preferences:{theme:"light",language:"zh-CN",timezone:"Asia/Shanghai",emailNotifications:!0,pushNotifications:!0},loginSuccess:t=>{const{username:a,userId:s,role:n,github:l=null,token:r,email:i,avatar:o=null,bio:c=null}=t,d=Date.now();e({username:a,userId:s,role:n,github:l,email:i,token:r,avatar:o,bio:c,isAuthenticated:!0,loginTime:d,lastActiveTime:d,error:null,loading:!1}),de("userInfo",{username:a,userId:s,role:n,github:l,token:r,email:i,avatar:o,bio:c,loginTime:d})},logout:()=>{var t;e({username:"",userId:0,role:2,github:null,email:null,token:null,avatar:null,bio:null,isAuthenticated:!1,loginTime:null,lastActiveTime:null,error:null,loading:!1}),t="userInfo",localStorage.removeItem(t)},setLoading:t=>e({loading:t}),setError:t=>e({error:"string"==typeof t?t:(null==t?void 0:t.message)||"未知错误",loading:!1}),clearError:()=>e({error:null}),initUser:()=>{const a=t("userInfo");if(a&&a.token){const s=Date.now();s-(a.loginTime||0)<6048e5?e({...a,isAuthenticated:!0,lastActiveTime:s}):t().logout()}},updateUserInfo:a=>{const s=t(),n={...s,...a};e(n),s.isAuthenticated&&de("userInfo",{username:n.username,userId:n.userId,role:n.role,github:n.github,token:n.token,email:n.email,avatar:n.avatar,bio:n.bio,loginTime:n.loginTime})},updatePreferences:a=>{const{preferences:s}=t();e({preferences:{...s,...a}})},updateLastActiveTime:()=>{e({lastActiveTime:Date.now()})},hasPermission:e=>{const{role:a,isAuthenticated:s}=t();return!!s&&a<=e},isAdmin:()=>{const{role:e,isAuthenticated:a}=t();return a&&e<=1},isSuperAdmin:()=>{const{role:e,isAuthenticated:a}=t();return a&&0===e},getUserSummary:()=>{const e=t();return{username:e.username,email:e.email,avatar:e.avatar,role:e.role,isAuthenticated:e.isAuthenticated,loginTime:e.loginTime,lastActiveTime:e.lastActiveTime}},getRoleName:()=>{const{role:e}=t();return{0:"超级管理员",1:"管理员",2:"普通用户"}[e]||"未知角色"},loginAsync:async e=>{const{setLoading:a,setError:s,loginSuccess:n,clearError:l}=t();try{a(!0),l();const t=(await oe(async()=>{const{default:e}=await Promise.resolve().then(()=>Ge);return{default:e}},void 0)).default,{message:s}=await oe(async()=>{const{message:e}=await import("./react-vendor-DCjvIuTI.js").then(e=>e.b3);return{message:e}},__vite__mapDeps([0,1])),r=(await oe(async()=>{const{default:e}=await import("./public-components-C6eUVMn5.js").then(e=>e.p);return{default:e}},__vite__mapDeps([2,0,1,3]))).default;void 0!==e.password&&(e.password=r.encrypt(e.password));const i=await t.post("/login",e);return n(i),s.success("登录成功, 欢迎您 ".concat(i.username)),i}catch(r){throw s(r),r}},reset:()=>{e({username:"",role:2,userId:0,github:null,email:null,token:null,avatar:null,bio:null,isAuthenticated:!1,loginTime:null,lastActiveTime:null,loading:!1,error:null})}}),{name:"user-storage",storage:s(()=>localStorage),partialize:e=>({username:e.username,userId:e.userId,role:e.role,github:e.github,email:e.email,token:e.token,avatar:e.avatar,bio:e.bio,isAuthenticated:e.isAuthenticated,loginTime:e.loginTime,preferences:e.preferences})}))),me=["magenta","blue","red","volcano","orange","gold","lime","green","cyan","geekblue","purple"],he=15,ge=15,pe=10,fe=(e,t=!0)=>{const a=new n.Renderer;a.old_paragraph=a.paragraph,a.paragraph=function(e){var t=/\$(.*)\$/g.test(e),a=/^\$\$(\s*.*\s*)\$\$$/.test(e);return e=!a&&t?e.replace(/(\$([^\$]*)\$)+/g,function(e,t){return t.indexOf("<code>")>=0||t.indexOf("</code>")>=0?t:"<span class='marked_inline_tex'>"+t.replace(/\$/g,"")+"</span>"}):a?"<div class='marked_tex'>"+e.replace(/\$/g,"")+"</div>":e,e=this.old_paragraph(e)};const s=n(e,{renderer:a,pedantic:!1,gfm:!0,tables:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1,highlight:function(e){return hljs.highlightAuto(e).value}});return t?l.sanitize(s,{ALLOWED_TAGS:["p","br","strong","em","u","ol","ul","li","a","img","code","pre","blockquote","h1","h2","h3","h4","h5","h6","span","div","table","tr","td","th","thead","tbody"],ALLOWED_ATTR:["href","src","alt","class","id","title","target"],FORBID_TAGS:["script","object","embed","form","input"],FORBID_ATTR:["onerror","onload","onclick","onmouseover"]}):s},xe=fe,ye=e=>{const t={};return e.replace(/\.*\?/,"").split("&").forEach(e=>{const a=e.split("=");a[1]&&a[0]&&(t[a[0]]=a[1])}),t},je=e=>{let t=e.length;return e.forEach(e=>{t+=e.replies.length}),t},be=(e,t)=>{const a={};e.forEach(e=>{const s=JSON.stringify(t(e));a[s]=a[s]||[],a[s].push(e)});var s=Object.keys(a).sort().reverse();return Object.keys(a).map((e,t)=>a[s[t]])};function ve(){let e="";const t=ce("userInfo");return t&&t.token&&(e="Bearer "+t.token),e}function Se(e=[],t=me){const a=[...e];return a.forEach((e,a)=>{var s;e.color=t[a]||t[(s=t,Math.floor(Math.random()*s.length))]}),a}const Ce=e(a(r((e,t)=>({articleList:[],currentArticle:null,articleCache:{},categoryList:[],tagList:[],filters:{category:null,tag:null,keyword:"",status:"all",author:null},pagination:{current:1,pageSize:10,total:0},sorting:{field:"createdAt",order:"desc"},loading:!1,submitting:!1,error:null,selectedArticles:[],batchOperationLoading:!1,setArticleList:(t,a=null)=>e(e=>{e.articleList=t,a&&(e.pagination={...e.pagination,...a}),e.loading=!1,e.error=null}),setCurrentArticle:t=>e(e=>{e.currentArticle=t,t&&t.id&&(e.articleCache[t.id]=t)}),getArticleFromCache:e=>t().articleCache[e]||null,setTagList:t=>e(e=>{e.tagList=Se(t)}),setCategoryList:t=>e(e=>{e.categoryList=Se(t)}),addArticle:t=>e(e=>{e.articleList.unshift(t),t.id&&(e.articleCache[t.id]=t),e.pagination.total+=1}),updateArticle:t=>e(e=>{var a;const s=e.articleList.findIndex(e=>e.id===t.id);-1!==s&&(e.articleList[s]=t),t.id&&(e.articleCache[t.id]=t),(null==(a=e.currentArticle)?void 0:a.id)===t.id&&(e.currentArticle=t)}),removeArticle:t=>e(e=>{var a;e.articleList=e.articleList.filter(e=>e.id!==t),delete e.articleCache[t],(null==(a=e.currentArticle)?void 0:a.id)===t&&(e.currentArticle=null),e.pagination.total=Math.max(0,e.pagination.total-1),e.selectedArticles=e.selectedArticles.filter(e=>e!==t)}),batchRemoveArticles:t=>e(e=>{e.articleList=e.articleList.filter(e=>!t.includes(e.id)),t.forEach(t=>{delete e.articleCache[t]}),e.currentArticle&&t.includes(e.currentArticle.id)&&(e.currentArticle=null),e.pagination.total=Math.max(0,e.pagination.total-t.length),e.selectedArticles=[]}),addTag:t=>e(e=>{const a=Se([t])[0];e.tagList.find(e=>e.id===t.id||e.name===t.name)||e.tagList.push(a)}),addCategory:t=>e(e=>{const a=Se([t])[0];e.categoryList.find(e=>e.id===t.id||e.name===t.name)||e.categoryList.push(a)}),updateFilters:t=>e(e=>{e.filters={...e.filters,...t},e.pagination.current=1}),resetFilters:()=>e(e=>{e.filters={category:null,tag:null,keyword:"",status:"all",author:null},e.pagination.current=1}),updatePagination:t=>e(e=>{e.pagination={...e.pagination,...t}}),updateSorting:t=>e(e=>{e.sorting={...e.sorting,...t},e.pagination.current=1}),setSelectedArticles:t=>e(e=>{e.selectedArticles=Array.isArray(t)?t:[]}),toggleArticleSelection:t=>e(e=>{const a=e.selectedArticles.indexOf(t);a>-1?e.selectedArticles.splice(a,1):e.selectedArticles.push(t)}),toggleSelectAll:()=>e(e=>{e.selectedArticles.length===e.articleList.length?e.selectedArticles=[]:e.selectedArticles=e.articleList.map(e=>e.id)}),setLoading:t=>e(e=>{e.loading=t}),setSubmitting:t=>e(e=>{e.submitting=t}),setBatchOperationLoading:t=>e(e=>{e.batchOperationLoading=t}),setError:t=>e(e=>{e.error="string"==typeof t?t:(null==t?void 0:t.message)||"未知错误",e.loading=!1,e.submitting=!1,e.batchOperationLoading=!1}),clearError:()=>e(e=>{e.error=null}),getQueryParams:()=>{const{filters:e,pagination:a,sorting:s}=t();return{...e,page:a.current,pageSize:a.pageSize,sortField:s.field,sortOrder:s.order}},getArticleStats:()=>{const{articleList:e,categoryList:a,tagList:s}=t();return{totalArticles:e.length,totalCategories:a.length,totalTags:s.length,publishedArticles:e.filter(e=>"published"===e.status).length,draftArticles:e.filter(e=>"draft"===e.status).length}},clearArticles:()=>e(e=>{e.articleList=[],e.currentArticle=null,e.articleCache={},e.selectedArticles=[],e.pagination={current:1,pageSize:10,total:0}}),reset:()=>e(e=>{e.articleList=[],e.currentArticle=null,e.articleCache={},e.categoryList=[],e.tagList=[],e.filters={category:null,tag:null,keyword:"",status:"all",author:null},e.pagination={current:1,pageSize:10,total:0},e.sorting={field:"createdAt",order:"desc"},e.selectedArticles=[],e.loading=!1,e.submitting=!1,e.batchOperationLoading=!1,e.error=null})})),{name:"article-storage",storage:s(()=>localStorage),partialize:e=>({categoryList:e.categoryList,tagList:e.tagList,filters:e.filters,sorting:e.sorting,pagination:{pageSize:e.pagination.pageSize}})})),we="light",ke="dark",Te="auto",Ae=()=>"undefined"==typeof window?we:window.matchMedia("(prefers-color-scheme: dark)").matches?ke:we,Ne=e=>{const t=document.documentElement,a=e===Te?Ae():e;t.setAttribute("data-theme",a);const s=document.querySelector('meta[name="theme-color"]');s&&s.setAttribute("content",a===ke?"#1a202c":"#ffffff"),document.startViewTransition&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches&&document.startViewTransition(()=>{t.setAttribute("data-theme",a)})},_e=e(a((e,t)=>({theme:Te,actualTheme:Ae(),isTransitioning:!1,primaryColor:"#ff69b4",setTheme:t=>{e({isTransitioning:!0}),setTimeout(()=>{const a=t===Te?Ae():t;Ne(t),e({theme:t,actualTheme:a,isTransitioning:!1})},50)},toggleTheme:()=>{const{theme:e}=t(),a=e===we?ke:we;t().setTheme(a)},setDarkMode:e=>{t().setTheme(e?ke:we)},setPrimaryColor:t=>{e({primaryColor:t})},setThemeSettings:t=>{e(t)},resetTheme:()=>{e({theme:Te,primaryColor:"#ff69b4"})},watchSystemTheme:()=>{if("undefined"==typeof window)return;const a=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{const{theme:a}=t();if(a===Te){const t=Ae();Ne(Te),e({actualTheme:t})}};return a.addEventListener("change",s),()=>a.removeEventListener("change",s)},initTheme:()=>{const{theme:a}=t(),s=a===Te?Ae():a;return Ne(a),e({actualTheme:s}),t().watchSystemTheme()},getThemeConfig:()=>{const{actualTheme:e,primaryColor:a}=t(),s=e===ke;return{isDark:s,isLight:e===we,primaryColor:a,actualTheme:e,themeClass:"theme-".concat(e),backgroundColor:s?"#1a202c":"#ffffff",textColor:s?"#f7fafc":"#2d3748"}},getThemeClasses:()=>{const{actualTheme:e}=t();return{isDark:e===ke,isLight:e===we,themeClass:"theme-".concat(e)}}}),{name:"moe-theme-storage",partialize:e=>({theme:e.theme,primaryColor:e.primaryColor}),onRehydrateStorage:()=>e=>{e&&setTimeout(()=>{e.initTheme()},0)}})),Le=e(a((e,t)=>({loading:!1,error:null,notification:null,sidebarCollapsed:!1,modalStates:{},settings:{pageSize:10,autoSave:!0,enableNotifications:!0,compactMode:!1},setLoading:t=>e({loading:t}),setError:t=>e({error:"string"==typeof t?t:(null==t?void 0:t.message)||"未知错误",loading:!1}),clearError:()=>e({error:null}),showNotification:a=>{e({notification:a}),setTimeout(()=>{t().notification===a&&e({notification:null})},5e3)},clearNotification:()=>e({notification:null}),toggleSidebar:()=>{const{sidebarCollapsed:a}=t();e({sidebarCollapsed:!a})},setSidebarCollapsed:t=>e({sidebarCollapsed:t}),setModalOpen:(a,s)=>{const{modalStates:n}=t();e({modalStates:{...n,[a]:s}})},getModalState:e=>{const{modalStates:a}=t();return a[e]||!1},updateSettings:a=>{const{settings:s}=t();e({settings:{...s,...a}})},resetSettings:()=>{e({settings:{pageSize:10,autoSave:!0,enableNotifications:!0,compactMode:!1}})},reset:()=>{e({loading:!1,error:null,notification:null,modalStates:{}})},getAppStatus:()=>{const e=t();return{isLoading:e.loading,hasError:!!e.error,hasNotification:!!e.notification,activeModals:Object.keys(e.modalStates).filter(t=>e.modalStates[t]).length}}}),{name:"app-storage",storage:s(()=>localStorage),partialize:e=>({sidebarCollapsed:e.sidebarCollapsed,settings:e.settings})})),Ie=e(r((e,t)=>({comments:{},loadingStates:{},submitStates:{},errors:{},totalCounts:{},replyingTo:null,editingComment:null,setComments:(t,a)=>e(e=>{e.comments[t]=a,e.totalCounts[t]=a.length,e.loadingStates[t]=!1,e.errors[t]=null}),addComment:(t,a)=>e(e=>{if(e.comments[t]||(e.comments[t]=[]),a.parentId){const s=e.comments[t].find(e=>e.id===a.parentId);s&&(s.replies||(s.replies=[]),s.replies.unshift(a))}else e.comments[t].unshift(a);e.totalCounts[t]=(e.totalCounts[t]||0)+1,e.submitStates[t]=!1}),updateComment:(t,a,s)=>e(e=>{const n=e.comments[t]||[],l=e=>{for(let t of e){if(t.id===a)return Object.assign(t,s),!0;if(t.replies&&l(t.replies))return!0}return!1};l(n)}),deleteComment:(t,a)=>e(e=>{const s=e.comments[t]||[],n=s=>{for(let l=0;l<s.length;l++){if(s[l].id===a)return s.splice(l,1),e.totalCounts[t]=Math.max(0,(e.totalCounts[t]||0)-1),!0;if(s[l].replies&&n(s[l].replies))return!0}return!1};n(s)}),toggleLike:(t,a,s,n)=>e(e=>{const l=e.comments[t]||[],r=e=>{for(let t of e){if(t.id===a)return t.isLiked=s,t.likeCount=n,!0;if(t.replies&&r(t.replies))return!0}return!1};r(l)}),setLoading:(t,a)=>e(e=>{e.loadingStates[t]=a}),setSubmitting:(t,a)=>e(e=>{e.submitStates[t]=a}),setError:(t,a)=>e(e=>{e.errors[t]=a,e.loadingStates[t]=!1,e.submitStates[t]=!1}),clearError:t=>e(e=>{e.errors[t]=null}),setReplyingTo:t=>e(e=>{e.replyingTo=t,e.editingComment=null}),setEditingComment:t=>e(e=>{e.editingComment=t,e.replyingTo=null}),clearOperationStates:()=>e(e=>{e.replyingTo=null,e.editingComment=null}),getArticleComments:e=>{const a=t();return{comments:a.comments[e]||[],loading:a.loadingStates[e]||!1,submitting:a.submitStates[e]||!1,error:a.errors[e]||null,totalCount:a.totalCounts[e]||0}},getCommentStats:e=>{const a=t().comments[e]||[];let s=0;const n=e=>{e.forEach(e=>{e.replies&&(s+=e.replies.length,n(e.replies))})};return n(a),{totalComments:a.length,totalReplies:s,totalCount:a.length+s}},clearArticleComments:t=>e(e=>{delete e.comments[t],delete e.loadingStates[t],delete e.submitStates[t],delete e.errors[t],delete e.totalCounts[t]}),reset:()=>e(e=>{e.comments={},e.loadingStates={},e.submitStates={},e.errors={},e.totalCounts={},e.replyingTo=null,e.editingComment=null})}))),Ee=e=>o.jsx("svg",{className:"svg-icon ".concat(e.className),"aria-hidden":"true",style:e.style,children:o.jsx("use",{xlinkHref:"#".concat(e.type)})});function De({children:e,href:t,...a}){let s=t;return/^(https?:|mailto:|tel:|http:)/.test(t)||(s="http://".concat(t)),o.jsx("a",{target:"_blank",rel:"noreferrer noopener",...a,href:s,children:e})}Ee.propTypes={type:i.string.isRequired,className:i.string},Ee.defaultProps={className:""};const Oe="http://127.0.0.1:6060",Pe=Oe,ze="您的博客名称",Fe={avatar:require("@/assets/images/avatar.jpg"),title:"八云澈的小站",subTitle:"睡了已经肝不动了",homepages:{github:{link:"https://github.com/your-username",icon:o.jsx(c,{className:"homepage-icon"})}},friendslink:{}},Me=Fe.avatar,Be={client_id:"",url:"https://github.com/login/oauth/authorize"},Re={describe:Fe.subTitle,renderMyInfo:o.jsx(re,{})},qe={enable:!1};function Ue(e){d.useEffect(()=>{"function"==typeof e&&e()},[])}const Ye=u.createContext(null);function $e(){return u.useContext(Ye)}function Je(e,t){const a=$e();u.useEffect(()=>(a.on(e,t),()=>{a.off(e,t)}),[a,e,t])}const Ke=m.create({baseURL:Oe,timeout:1e4});let Ve;Ke.interceptors.request.use(e=>{const t=ve();return t&&(e.headers.common.Authorization=t),e},e=>{h.error("bed request"),Promise.reject(e)}),Ke.interceptors.response.use(e=>e.data,e=>(clearTimeout(Ve),Ve=setTimeout(()=>{if(e.response){const{status:t,data:a}=e.response;if(401===t)h.error(a&&a.message||"登录信息过期或未授权，请重新登录！");else h.error(a.message||"连接错误 ".concat(t,"！"))}},200),Promise.reject(e)));const Ge=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"}));g.extend(p),g.extend(f);const He=Object.freeze(Object.defineProperty({__proto__:null,default:()=>o.jsx("div",{className:"loading-wrapper",style:{height:600},children:o.jsxs("div",{className:"minions",children:[o.jsx("div",{className:"body",children:o.jsxs("div",{className:"trousers",children:[o.jsxs("div",{className:"condole-belt",children:[o.jsx("div",{className:"left"}),o.jsx("div",{className:"right"})]}),o.jsx("div",{className:"trousers-top"}),o.jsx("div",{className:"pocket"}),o.jsx("span",{className:"line-left"}),o.jsx("span",{className:"line-right"}),o.jsx("span",{className:"line-bottom"})]})}),o.jsxs("div",{className:"hair",children:[o.jsx("span",{className:"left-hair-one"}),o.jsx("span",{className:"left-hair-two"})]}),o.jsxs("div",{className:"eyes",children:[o.jsx("div",{className:"left-eye",children:o.jsx("div",{className:"left-black-eye",children:o.jsx("div",{className:"left-white"})})}),o.jsx("div",{className:"right-eye",children:o.jsx("div",{className:"right-black-eye",children:o.jsx("div",{className:"right-white"})})})]}),o.jsx("div",{className:"mouse",children:o.jsx("div",{className:"mouse-shape"})}),o.jsxs("div",{className:"hands",children:[o.jsx("div",{className:"left-hand"}),o.jsx("div",{className:"right-hand"})]}),o.jsxs("div",{className:"feet",children:[o.jsx("div",{className:"left-foot"}),o.jsx("div",{className:"right-foot"})]}),o.jsx("div",{className:"ground-shadow"})]})})},Symbol.toStringTag,{value:"Module"}));function We(e=[]){const t=$e();d.useEffect(()=>(t.emit("breadcrumbList",e),()=>{t.emit("breadcrumbList",[])}),[])}function Qe(e){const t=document.createElement("a"),a=ve();t.href=a?"".concat(Oe).concat(e,"?token=").concat(a):"".concat(Oe).concat(e),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Ze({requestUrl:e="",queryParams:t=null,columns:a=[],isAdmin:s=!0}){const[n,l]=d.useState(!1),[r,i]=d.useState([]),[o,c]=d.useState({current:1,pageSize:10,totoal:0});function u(a){const s={page:o.current,pageSize:o.pageSize,...t,...a};Ke.get(e,{params:s}).then(e=>{const{page:t,pageSize:a}=s,{count:n,rows:r}=e;if(n>0&&n>a){const e=Math.ceil(n/a);if(e<t)return u({page:e})}o.current=t,o.total=n,c({...o}),i(r),l(!1)}).catch(e=>{l(!1)})}async function m(e){l(!0),u(e)}return Ue(m),{tableProps:{className:s?"admin-table":"",rowKey:"id",loading:n,columns:a,dataSource:r,pagination:{current:o.current,pageSize:o.pageSize,total:o.total,showTotal:e=>"共 ".concat(e," 条")},onChange:function(e,t,a){"{}"===JSON.stringify(t)&&"{}"===JSON.stringify(a)&&m({page:e.current,pageSize:e.pageSize})}},dataList:r,updateList:d.useCallback(async function(e){try{l(!0),await e(),u()}catch(t){l(!1)}},[o,t]),onSearch:d.useCallback(function(e){m({page:1,...e})},[o,t]),setLoading:d.useCallback(l,[])}}const Xe=({tagList:e=[],categoryList:t=[],filterForm:a={},onSearch:s,onReset:n,onExportAll:l,loading:r=!1,hasActiveFilters:i=!1,filtersSummary:c=[],className:d=""})=>{const[u]=b.useForm(),m=()=>{u.resetFields(),null==n||n()};return o.jsxs("div",{className:"article-filters ".concat(d),children:[o.jsx("div",{className:"article-filters__form",children:o.jsxs(b,{form:u,layout:"inline",initialValues:a,onFinish:e=>{null==s||s(e)},className:"search-form",children:[o.jsx(b.Item,{label:"关键词",name:"keyword",children:o.jsx(v,{placeholder:"请输入文章关键词",allowClear:!0,style:{width:200}})}),o.jsx(b.Item,{label:"标签",name:"tag",children:o.jsx(S,{placeholder:"请选择标签",allowClear:!0,style:{width:200},children:e.map(e=>o.jsx(S.Option,{value:e.name,children:e.name},e.name))})}),o.jsx(b.Item,{label:"分类",name:"category",children:o.jsx(S,{placeholder:"请选择分类",allowClear:!0,style:{width:200},children:t.map(e=>o.jsx(S.Option,{value:e.name,children:e.name},e.name))})}),o.jsx(b.Item,{label:"私密性",name:"type",children:o.jsxs(S,{placeholder:"请选择私密性",allowClear:!0,style:{width:200},children:[o.jsx(S.Option,{value:!0,children:"公开"}),o.jsx(S.Option,{value:!1,children:"私密"})]})}),o.jsx(b.Item,{children:o.jsxs(C,{children:[o.jsx(w,{type:"primary",htmlType:"submit",icon:o.jsx(k,{}),loading:r,children:"搜索"}),o.jsx(w,{onClick:m,icon:o.jsx(T,{}),disabled:r,children:"重置"}),o.jsx(w,{type:"default",onClick:l,icon:o.jsx(A,{}),loading:r,children:"导出全部"})]})})]})}),i&&c.length>0&&o.jsxs("div",{className:"article-filters__summary",children:[o.jsx("span",{className:"summary-label",children:"当前搜索条件："}),o.jsx(C,{wrap:!0,children:c.map((e,t)=>o.jsx(y,{color:"blue",closable:!1,children:e},t))}),o.jsx(w,{type:"link",size:"small",onClick:m,className:"clear-filters-btn",children:"清空条件"})]})]})},et=({tableProps:e,rowSelection:t,footer:a,loading:s=!1,className:n=""})=>o.jsx("div",{className:"article-table ".concat(n),children:o.jsx(N,{...e,rowSelection:t,loading:s,scroll:{x:1200},size:"middle",footer:a,pagination:{...e.pagination,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>"第 ".concat(t[0],"-").concat(t[1]," 条，共 ").concat(e," 条记录"),pageSizeOptions:["10","20","50","100"]},rowKey:"id",className:"article-table__table"})}),tt=({batchMode:e=!1,hasSelection:t=!1,selectionCount:a=0,loading:s=!1,onToggleBatchMode:n,onBatchDelete:l,onBatchExport:r,onBatchSetPublic:i,onBatchSetPrivate:c,onBatchSetTop:d,onBatchUnsetTop:u,className:m=""})=>{const h=o.jsxs(_,{children:[o.jsx(_.Item,{icon:o.jsx(L,{}),onClick:i,disabled:!t||s,children:"设为公开"},"set-public"),o.jsx(_.Item,{icon:o.jsx(I,{}),onClick:c,disabled:!t||s,children:"设为私密"},"set-private"),o.jsx(_.Divider,{}),o.jsx(_.Item,{icon:o.jsx(E,{}),onClick:d,disabled:!t||s,children:"设为置顶"},"set-top"),o.jsx(_.Item,{icon:o.jsx(D,{}),onClick:u,disabled:!t||s,children:"取消置顶"},"unset-top")]});return o.jsxs("div",{className:"batch-actions ".concat(m),children:[o.jsxs("div",{className:"batch-actions__toggle",children:[o.jsx("span",{className:"toggle-label",children:"批量操作"}),o.jsx(O,{checked:e,onChange:n,loading:s})]}),e&&o.jsxs("div",{className:"batch-actions__operations",children:[o.jsx("div",{className:"selection-info",children:o.jsx(P,{count:a,showZero:!0,style:{backgroundColor:"#52c41a"},children:o.jsx("span",{className:"selection-text",children:"已选中"})})}),o.jsxs(C,{size:"small",children:[o.jsx(w,{type:"primary",size:"small",icon:o.jsx(A,{}),onClick:r,disabled:!t||s,loading:s,children:"导出选中"}),o.jsx(j,{title:"确定要删除选中的 ".concat(a," 篇文章吗？"),description:"删除后无法恢复，请谨慎操作。",onConfirm:l,okText:"确定删除",cancelText:"取消",okType:"danger",disabled:!t||s,children:o.jsx(w,{type:"primary",danger:!0,size:"small",icon:o.jsx(z,{}),disabled:!t||s,loading:s,children:"批量删除"})}),o.jsx(F,{overlay:h,trigger:["click"],disabled:!t||s,children:o.jsx(w,{size:"small",icon:o.jsx(M,{}),children:"更多操作"})})]})]})]})},at=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{We(["文章管理"]);const e=Ce(e=>e.tagList),t=Ce(e=>e.categoryList),{queryParams:a,filterForm:s,handleSearch:n,resetFilters:l,hasActiveFilters:r,getFiltersSummary:i}=(e=>{const[t,a]=d.useState({}),[s,n]=d.useState({keyword:"",tag:void 0,category:void 0,type:void 0}),l=d.useCallback(()=>{const t={};a(t),n({keyword:"",tag:void 0,category:void 0,type:void 0}),e(t)},[e]),r=d.useCallback(l=>{try{const r=Object.keys(l).reduce((e,t)=>{const a=l[t];return null!=a&&""!==a&&(e[t]=a),e},{}),i={...t,...r};a(i),n({...s,...l}),e(i)}catch(r){}},[t,s,e]),i=d.useCallback((l,r)=>{const i={...s,[l]:r};n(i);const o={...t};null==r||""===r?delete o[l]:o[l]=r,a(o),e(o)},[s,t,e]),o=d.useCallback((e,t)=>({keyword:{label:"关键词",placeholder:"请输入文章关键词",allowClear:!0},tag:{label:"标签",placeholder:"请选择标签",allowClear:!0,options:e.map(e=>({label:e.name,value:e.name}))},category:{label:"分类",placeholder:"请选择分类",allowClear:!0,options:t.map(e=>({label:e.name,value:e.name}))},type:{label:"私密性",placeholder:"请选择私密性",allowClear:!0,options:[{label:"公开",value:!0},{label:"私密",value:!1}]}}),[]),c=d.useCallback(()=>Object.keys(t).length>0,[t]),u=d.useCallback(()=>{const e=[];return t.keyword&&e.push("关键词: ".concat(t.keyword)),t.tag&&e.push("标签: ".concat(t.tag)),t.category&&e.push("分类: ".concat(t.category)),void 0!==t.type&&e.push("私密性: ".concat(t.type?"公开":"私密")),e},[t]);return{queryParams:t,filterForm:s,handleSearch:r,resetFilters:l,updateFilter:i,getSearchOptions:o,hasActiveFilters:c,getFiltersSummary:u}})(e=>{m(e)}),c=e=>{B.open({message:"分享链接",description:o.jsxs("div",{children:[o.jsx("p",{children:"请复制以下链接进行分享："}),o.jsx("p",{style:{background:"#f5f5f5",padding:"8px",borderRadius:"4px",wordBreak:"break-all",userSelect:"all"},children:e})]}),duration:0,style:{width:"500px"}})},{tableProps:u,onSearch:m}=(({queryParams:e,tagList:t,categoryList:a,onCopyShare:s,onExport:n})=>{const l=(e,t)=>{const a=t.find(t=>t.name===e);return a&&a.color},r=d.useMemo(()=>[{title:"标题",dataIndex:"title",key:"title",ellipsis:!0,render:(e,t)=>o.jsx(x,{to:"/article/".concat(t.id),className:"article-title-link",children:e})},{title:"标签",dataIndex:"tags",key:"tags",width:200,render:e=>o.jsx("div",{className:"tags-container",children:e.map(e=>o.jsx(y,{color:l(e.name,t),children:o.jsx(x,{to:"/tags/".concat(e.name),children:e.name})},e.name))})},{title:"分类",dataIndex:"categories",key:"categories",width:150,render:e=>o.jsx("div",{className:"categories-container",children:e.map(e=>o.jsx(y,{color:"#2db7f5",children:o.jsx(x,{to:"/categories/".concat(e.name),children:e.name})},e.name))})},{title:"浏览数",dataIndex:"viewCount",key:"viewCount",width:100,sorter:(e,t)=>t.viewCount-e.viewCount,render:e=>o.jsx("span",{className:"view-count",children:e||0})},{title:"私密性",dataIndex:"type",key:"type",width:100,render:e=>o.jsx(y,{color:e?"#52c41a":"#ff4d4f",children:e?"公开":"私密"})},{title:"置顶",dataIndex:"top",key:"top",width:100,render:e=>o.jsx(y,{color:e?"#722ed1":"#d9d9d9",children:e?"置顶":"普通"})},{title:"发布时间",dataIndex:"createdAt",key:"createdAt",width:120,sorter:(e,t)=>g(e.createdAt).isBefore(t.createdAt)?1:-1,render:e=>g(e).format("YYYY-MM-DD")},{title:"修改时间",dataIndex:"updatedAt",key:"updatedAt",width:120,sorter:(e,t)=>g(e.updatedAt).isBefore(t.updatedAt)?1:-1,render:e=>g(e).format("YYYY-MM-DD")},{title:"操作",key:"actions",width:200,fixed:"right",render:(e,t)=>o.jsxs("ul",{className:"action-list",children:[o.jsx("li",{children:o.jsx(x,{to:"/article/".concat(t.id),children:"查看"})}),o.jsx("li",{children:o.jsx(x,{to:{pathname:"/admin/article/edit/".concat(t.uuid),state:{articleId:t.id}},children:"编辑"})}),o.jsx("li",{children:o.jsx("a",{onClick:()=>s(t.uuid),children:"分享"})}),o.jsx("li",{children:o.jsx("a",{onClick:()=>n(t.id,t.title),children:"导出"})}),o.jsx("li",{children:o.jsx(j,{title:"确定要删除这篇文章吗？",cancelText:"取消",okText:"确定",onConfirm:()=>m(t.id),children:o.jsx("a",{className:"delete-text",children:"删除"})})})]})}],[t,a,s,n]),{tableProps:i,updateList:c,onSearch:u}=Ze({requestUrl:"/article/list",queryParams:e,columns:r}),m=async e=>{try{await c(()=>Ke.delete("/article/".concat(e)))}catch(t){}};return{tableProps:i,updateList:c,onSearch:u,columns:r}})({queryParams:a,tagList:e,categoryList:t,onCopyShare:e=>{const t="".concat(Pe,"/article/share/").concat(e);navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(t).then(()=>{B.success({message:"分享链接已复制",description:t,duration:3})}).catch(()=>{c(t)}):c(t)},onExport:async(e,t)=>{try{await Qe("/article/output/".concat(e))}catch(a){}}}),{batchMode:p,loading:f,toggleBatchMode:b,getRowSelection:v,getSelectionInfo:S,batchDelete:C,batchExportSelected:w,exportAll:k,batchSetPublic:T,batchSetPrivate:A,batchSetTop:N,batchUnsetTop:_}=(e=>{const[t,a]=d.useState(!1),[s,n]=d.useState([]),[l,r]=d.useState(!1),i=d.useCallback(()=>{a(e=>{const t=!e;return t||n([]),t})},[]),o=d.useCallback(e=>{n(e)},[]),c=d.useCallback(()=>{n([])},[]),u=d.useCallback((e,t,a)=>{if(e){const e=t.map(e=>e.id);n(e)}else n([])},[]),m=d.useCallback(async()=>{if(0!==s.length){r(!0);try{await Ke.delete("/article/list/".concat(s.join(","))),h.success("成功删除 ".concat(s.length," 篇文章")),n([]),e()}catch(t){h.error("批量删除失败，请重试")}finally{r(!1)}}else h.warning("请先选择要删除的文章")},[s,e]),g=d.useCallback(async()=>{if(0!==s.length){r(!0);try{await Qe("/article/output/list/".concat(s.join(","))),h.success("文章导出已开始，请稍候下载")}catch(e){h.error("批量导出失败，请重试")}finally{r(!1)}}else h.warning("请先选择要导出的文章")},[s]),p=d.useCallback(async()=>{r(!0);try{await Qe("/article/output/all"),h.success("全部文章导出已开始，请稍候下载")}catch(e){h.error("导出全部文章失败，请重试")}finally{r(!1)}},[]),f=d.useCallback(async t=>{if(0!==s.length){r(!0);try{await Ke.put("/article/batch/status",{ids:s,...t}),h.success("成功更新 ".concat(s.length," 篇文章的状态")),n([]),e()}catch(a){h.error("批量更新失败，请重试")}finally{r(!1)}}else h.warning("请先选择要更新的文章")},[s,e]),x=d.useCallback(()=>{f({type:!0})},[f]),y=d.useCallback(()=>{f({type:!1})},[f]),j=d.useCallback(()=>{f({top:!0})},[f]),b=d.useCallback(()=>{f({top:!1})},[f]),v=d.useCallback(()=>t?{selectedRowKeys:s,onChange:o,onSelectAll:u,selections:[{key:"select-all",text:"全选当前页",onSelect:e=>{n(e)}},{key:"select-none",text:"清空选择",onSelect:()=>{n([])}}]}:null,[t,s,o,u]),S=d.useCallback(()=>({hasSelection:s.length>0,selectionCount:s.length,selectedKeys:s}),[s]);return{batchMode:t,selectedRowKeys:s,loading:l,toggleBatchMode:i,clearSelection:c,getRowSelection:v,getSelectionInfo:S,batchDelete:m,batchExportSelected:g,exportAll:p,batchSetPublic:x,batchSetPrivate:y,batchSetTop:j,batchUnsetTop:b}})(()=>{m(a)}),{hasSelection:L,selectionCount:I}=S();return o.jsxs("div",{className:"article-manager",children:[o.jsxs("div",{className:"article-manager__header",children:[o.jsx("h2",{className:"page-title",children:"文章管理"}),o.jsx("p",{className:"page-description",children:"管理所有发布的文章，支持搜索、过滤、批量操作和导出功能"})]}),o.jsxs("div",{className:"article-manager__content",children:[o.jsx(Xe,{tagList:e,categoryList:t,filterForm:s,onSearch:n,onReset:l,onExportAll:k,loading:u.loading||f,hasActiveFilters:r(),filtersSummary:i()}),o.jsx(et,{tableProps:u,rowSelection:v(),footer:()=>o.jsx(tt,{batchMode:p,hasSelection:L,selectionCount:I,loading:f,onToggleBatchMode:b,onBatchDelete:C,onBatchExport:w,onBatchSetPublic:T,onBatchSetPrivate:A,onBatchSetTop:N,onBatchUnsetTop:_}),loading:u.loading||f})]})]})}},Symbol.toStringTag,{value:"Module"})),st=e=>{const t=Ce(e=>e.tagList),a=Ce(e=>e.categoryList),s={authorId:ue(e=>e.userId)},[n,l]=d.useState(0),[r,i]=d.useState(!1),[o,c]=d.useState(null),[u,m]=d.useState(""),[h,g]=d.useState(""),[p,f]=d.useState(!0),[x,y]=d.useState(!1),[j,b]=d.useState([]),[v,S]=d.useState([]),[C,w]=d.useState([]),[k,T]=d.useState([]),A=async e=>{i(!0),c(null);try{const t=await Ke.get("/article/share/".concat(e,"?type=0"));l(t.id),m(t.title),g(t.content),f(t.type),y(t.top);const a=t.tags.map(e=>e.name),s=t.categories.map(e=>e.name);b(a),S(s),w(a),T(s)}catch(t){c(t.message||"获取文章失败")}finally{i(!1)}};return d.useEffect(()=>{e&&A(e)},[e]),d.useEffect(()=>{!e&&t.length>0&&a.length>0&&(()=>{const e=t.map(e=>e.name).slice(0,10),s=a.map(e=>e.name).slice(0,10);b(e),S(s),e[0]&&w([e[0]]),s[0]&&T([s[0]])})()},[e,t,a]),{realId:n,loading:r,error:o,title:u,content:h,type:p,top:x,tagList:j,categoryList:v,tagSelectedList:C,cateSelectedList:k,setTitle:m,setContent:g,setType:f,setTop:y,setTagSelectedList:w,setCateSelectedList:T,setError:c,fetchArticle:A,resetForm:()=>{m(""),g(""),f(!0),y(!1),w([]),T([]),c(null)},validateForm:()=>u.trim()?h.trim()?0===C.length?(c("请至少选择一个标签"),!1):0!==k.length||(c("请至少选择一个分类"),!1):(c("内容不能为空"),!1):(c("标题不能为空"),!1),getFormData:()=>({title:u.trim(),content:h.trim(),tagList:C,categoryList:k,authorId:s.authorId,type:p,top:x}),getUpdateData:()=>({title:u.trim(),content:h.trim(),tags:C,categories:k,type:p,top:x}),isEdit:!!e,formTitle:e?"编辑文章":"新增文章"}};function nt(e){return o.jsx(q,{getMdeInstance:e=>{e.togglePreview()},value:e.value,onChange:e.onChange,options:{autofocus:!0,autosave:{enabled:!0,delay:1e3},previewRender:e=>fe(e)}})}const{CheckableTag:lt}=y;function rt(e){const{list:t,setList:a}=e,[s,n]=d.useState(!1),[l,r]=d.useState(""),{selectedList:i,setSelectedList:c}=e;let u=null;function m(){l&&!t.find(e=>e===l)&&(a([...t,l]),c([...i,l]),r("")),n(!1)}return o.jsxs(o.Fragment,{children:[t.map((e,s)=>{const n=e.length>20,l=o.jsx(lt,{closable:"true",onClose:()=>function(e){const s=t.filter(t=>t!==e);a(s)}(e),checked:i.includes(e),onChange:t=>function(e,t){const a=t?[...i,e]:i.filter(t=>t!==e);c(a)}(e,t),color:"#1890ff",children:n?"".concat(e.slice(0,20),"..."):e},e);return n?o.jsx(U,{title:e,children:l},e):l}),o.jsx(v,{style:{width:78,display:s?"inline":"none"},ref:e=>{u=e},type:"text",size:"small",value:l,onChange:e=>r(e.target.value),onBlur:m,onPressEnter:m}),!s&&o.jsxs(y,{onClick:function(){n(!0),u&&u.focus()},style:{background:"#fff",borderStyle:"dashed"},children:[o.jsx(Y,{})," New Tag"]})]})}const it=({tagList:e,selectedTags:t,onChange:a,placeholder:s="选择标签",className:n=""})=>o.jsx("div",{className:"tag-selector ".concat(n),children:o.jsx(rt,{list:e,selectedList:t,onSelectedListChange:a})}),ot=({title:e,content:t,type:a,top:s,tagList:n,categoryList:l,tagSelectedList:r,cateSelectedList:i,error:c,onTitleChange:d,onContentChange:u,onTypeChange:m,onTopChange:h,onTagChange:g,onCategoryChange:p,className:f=""})=>o.jsxs("div",{className:"article-form-fields ".concat(f),children:[c&&o.jsx($,{message:"表单验证失败",description:c,type:"error",showIcon:!0,closable:!0,className:"article-form-fields__error"}),o.jsxs("div",{className:"article-form-fields__field",children:[o.jsxs("label",{className:"article-form-fields__label",children:["文章标题 ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(v,{placeholder:"请输入文章标题",value:e,onChange:e=>d(e.target.value),className:"article-form-fields__title-input"})]}),o.jsxs("div",{className:"article-form-fields__controls",children:[o.jsx("div",{className:"article-form-fields__control-item",children:o.jsxs("label",{className:"article-form-fields__control-label",children:[o.jsx(O,{checked:a,onChange:m,checkedChildren:o.jsx(K,{}),unCheckedChildren:o.jsx(J,{})}),o.jsx("span",{className:"control-text",children:a?"发布文章":"保存草稿"})]})}),o.jsx("div",{className:"article-form-fields__control-item",children:o.jsxs("label",{className:"article-form-fields__control-label",children:[o.jsx(O,{checked:s,onChange:h}),o.jsx("span",{className:"control-text",children:"置顶文章"})]})})]}),o.jsxs("div",{className:"article-form-fields__field",children:[o.jsxs("label",{className:"article-form-fields__label",children:["文章标签 ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(it,{tagList:n,selectedTags:r,onChange:g,placeholder:"选择文章标签"})]}),o.jsxs("div",{className:"article-form-fields__field",children:[o.jsxs("label",{className:"article-form-fields__label",children:["文章分类 ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx(it,{tagList:l,selectedTags:i,onChange:p,placeholder:"选择文章分类"})]}),o.jsxs("div",{className:"article-form-fields__field",children:[o.jsxs("label",{className:"article-form-fields__label",children:["文章内容 ",o.jsx("span",{className:"required",children:"*"})]}),o.jsx("div",{className:"article-form-fields__editor",children:o.jsx(nt,{value:t,onChange:u})})]})]}),ct=({isEdit:e=!1,submitting:t=!1,canSubmit:a=!0,onSave:s,onSaveDraft:n,onPreview:l,onReset:r,className:i=""})=>o.jsxs("div",{className:"article-form-actions ".concat(i),children:[o.jsxs(C,{size:"middle",wrap:!0,children:[o.jsx(w,{type:"primary",icon:e?o.jsx(V,{}):o.jsx(G,{}),loading:t,disabled:!a,onClick:s,size:"large",children:e?"更新文章":"发布文章"}),!e&&o.jsx(w,{icon:o.jsx(H,{}),loading:t,disabled:!a,onClick:n,size:"large",children:"保存草稿"}),o.jsx(w,{icon:o.jsx(L,{}),disabled:!a,onClick:l,size:"large",children:"预览文章"}),!e&&o.jsx(w,{icon:o.jsx(T,{}),disabled:t,onClick:r,size:"large",children:"重置表单"})]}),o.jsxs("div",{className:"article-form-actions__tips",children:[o.jsxs("p",{children:["💡 ",o.jsx("strong",{children:"操作提示："})]}),o.jsxs("ul",{children:[o.jsxs("li",{children:[o.jsx("strong",{children:"发布文章："}),"文章将立即发布并对用户可见"]}),!e&&o.jsxs("li",{children:[o.jsx("strong",{children:"保存草稿："}),"文章保存为草稿状态，不会对用户展示"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"预览文章："}),"在新窗口中预览文章效果"]}),o.jsxs("li",{children:["文章支持 ",o.jsx("strong",{children:"Markdown"})," 语法，可以使用丰富的格式"]})]})]})]}),dt=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{id:e}=W();Q(),We([{link:"/admin/article/manager",name:"文章管理"},e?"编辑文章":"新增文章"]);const{loading:t,error:a,title:s,content:n,type:l,top:r,tagList:i,categoryList:c,tagSelectedList:u,cateSelectedList:m,realId:g,isEdit:p,formTitle:f,setTitle:x,setContent:y,setType:j,setTop:b,setTagSelectedList:v,setCateSelectedList:S,setError:C,validateForm:w,getFormData:k,getUpdateData:T,resetForm:A}=st(e),{submitting:N,createArticle:_,updateArticle:L,saveDraft:I,previewArticle:E}=(({onSuccess:e,onError:t}={})=>{const[s,n]=d.useState(!1);return{submitting:s,createArticle:async(s,l)=>{var r,i;n(!0);try{const t=await Ke.post("/article",s);return h.success("文章创建成功！"),R.confirm({title:"文章创建成功！是否立即查看？",content:"您可以选择查看刚创建的文章，或继续编辑其他内容。",okText:"立即查看",cancelText:"继续编辑",onOk:()=>{l&&l.push?l.push("/article/".concat(t.id)):"undefined"!=typeof window&&window.open("/article/".concat(t.id),"_blank")},onCancel:()=>{null==e||e(t,"continue")}}),null==e||e(t,"created"),t}catch(a){const s=(null==(i=null==(r=a.response)?void 0:r.data)?void 0:i.message)||a.message||"创建失败，请重试";throw h.error(s),null==t||t(a),a}finally{n(!1)}},updateArticle:async(s,l)=>{var r,i;n(!0);try{const t=await Ke.put("/article/".concat(s),l);return h.success("文章更新成功！"),null==e||e(t,"updated"),t}catch(a){const s=(null==(i=null==(r=a.response)?void 0:r.data)?void 0:i.message)||a.message||"更新失败，请重试";throw h.error(s),null==t||t(a),a}finally{n(!1)}},saveDraft:async s=>{var l,r;n(!0);try{const t={...s,type:!1,top:!1},a=await Ke.post("/article/draft",t);return h.success("草稿保存成功！"),null==e||e(a,"draft"),a}catch(a){const s=(null==(r=null==(l=a.response)?void 0:l.data)?void 0:r.message)||a.message||"保存草稿失败";throw h.error(s),null==t||t(a),a}finally{n(!1)}},previewArticle:e=>{try{const t={...e,previewMode:!0,previewTime:Date.now()};localStorage.setItem("articlePreview",JSON.stringify(t)),window.open("/article/preview","_blank")||h.warning("请允许弹窗以预览文章")}catch(a){h.error("预览失败")}}}})({onSuccess:(e,t)=>{"created"===t||"updated"===t||"continue"===t&&A()},onError:e=>{}}),D=s.trim()&&n.trim()&&!t;return t&&p?o.jsx("div",{className:"article-edit article-edit--loading",children:o.jsx("div",{className:"loading-spinner",children:"加载中..."})}):o.jsxs("div",{className:"article-edit",children:[o.jsxs("div",{className:"article-edit__header",children:[o.jsx("h2",{className:"article-edit__title",children:f}),o.jsx("p",{className:"article-edit__description",children:p?"编辑您的文章内容，修改后点击更新即可保存更改。":"创建一篇新文章，填写完整信息后可选择发布或保存为草稿。"})]}),o.jsxs("div",{className:"article-edit__content",children:[o.jsx(ot,{title:s,content:n,type:l,top:r,tagList:i,categoryList:c,tagSelectedList:u,cateSelectedList:m,error:a,onTitleChange:x,onContentChange:y,onTypeChange:j,onTopChange:b,onTagChange:v,onCategoryChange:S}),o.jsx(ct,{isEdit:p,submitting:N,canSubmit:D,onSave:async()=>{if(C(null),w())try{if(p){const e=T();await L(g,e)}else{const e=k();await _(e,history)}}catch(e){}},onSaveDraft:async()=>{if(C(null),s.trim())try{const e=k();await I(e),A()}catch(e){}else C("标题不能为空")},onPreview:()=>{if(!s.trim()||!n.trim())return void h.warning("请先填写标题和内容");const e=k();E(e)},onReset:()=>{A(),h.success("表单已重置")}})]}),o.jsx(Z,{})]})}},Symbol.toStringTag,{value:"Module"})),ut=[{value:1,label:"github 用户"},{value:2,label:"站内用户"}];const mt=Object.freeze(Object.defineProperty({__proto__:null,default:function(e){We(["用户管理"]);const[t,a]=d.useState({}),{tableProps:s,updateList:n,onSearch:l}=Ze({requestUrl:"/user/list",queryParams:t,columns:[{title:"用户名",dataIndex:"username"},{title:"邮箱",dataIndex:"email"},{title:"邮件通知",dataIndex:"notice",render:(e,t)=>o.jsx(O,{defaultChecked:e,onChange:e=>n(()=>Ke.put("/user/".concat(t.id),{notice:e}))})},{title:"禁言",dataIndex:"disabledDiscuss",render:(e,t)=>o.jsx(O,{defaultChecked:e,onChange:e=>n(()=>Ke.put("/user/".concat(t.id),{disabledDiscuss:e}))})},{title:"用户类型",dataIndex:"type",render:(e,t)=>t.github?o.jsx(y,{color:"#1890ff",children:"github 用户"}):o.jsx(y,{color:"magenta",children:"站内用户"})},{title:"注册时间",dataIndex:"createdAt",sorter:(e,t)=>g(e.createdAt).isBefore(t.createdAt)?1:-1},{dataIndex:"id",title:"操作",render:(e,t)=>o.jsx(j,{title:"Are you sure？",onConfirm:t=>n(()=>Ke.delete("/user/".concat(e))),children:o.jsx("a",{className:"delete-text",children:"Delete"})})}]});return o.jsxs(o.Fragment,{children:[o.jsxs(b,{layout:"inline",onSubmit:function(s){s.preventDefault(),e.form.validateFields((e,s)=>{e||(Array.isArray(s.rangeDate)&&(s.rangeDate=s.rangeDate.map(e=>e.format("YYYY-MM-DD"))),a({...t,...s}),l({...t,...s}))})},style:{marginBottom:20},children:[o.jsx(b.Item,{label:"姓名",name:"username",children:o.jsx(v,{placeholder:"请输入姓名",allowClear:!0})}),o.jsx(b.Item,{label:"用户类型",name:"type",children:o.jsx(S,{style:{width:200},allowClear:!0,children:ut.map(e=>o.jsx(S.Option,{value:e.value,children:e.label},e.value))})}),o.jsx(b.Item,{label:"创建日期",name:"rangeDate",children:o.jsx(X.RangePicker,{})}),o.jsx(b.Item,{children:o.jsx(w,{type:"primary",htmlType:"submit",style:{marginRight:8},children:"检索"})})]}),o.jsx(N,{...s})]})}},Symbol.toStringTag,{value:"Module"}));const ht=Object.freeze(Object.defineProperty({__proto__:null,default:function(e){We(["碎语管理"]);const[t,a]=d.useState({}),[s,n]=d.useState(!1),[l,r]=d.useState([]),{tableProps:i,updateList:c,onSearch:u}=Ze({requestUrl:"/fragment/list",queryParams:t,columns:[{title:"编号",dataIndex:"id"},{title:"作者",dataIndex:"author"},{title:"发布时间",dataIndex:"createdAt",sorter:(e,t)=>g(e.createdAt).isBefore(t.createdAt)?1:-1},{dataIndex:"id",title:"操作",render:(e,t)=>o.jsxs("ul",{className:"action-list",children:[o.jsx("li",{children:o.jsx(x,{to:{pathname:"/admin/fragment/edit/".concat(t.id),state:{articleId:e}},children:"编辑"})}),o.jsx("li",{children:o.jsx(j,{title:"Are you sure？",cancelText:"No",onConfirm:t=>c(()=>Ke.delete("/fragment/".concat(e))),children:o.jsx("a",{className:"delete-text",children:"删除"})})})]})}]});function m(){Ke.delete("/fragment/list/".concat(l)).then(()=>{u(),r([])})}const h=s?{selectedRowKeys:l,onChange:e=>r(e)}:null;return o.jsxs("div",{className:"admin-fragment-manager",children:[o.jsxs(b,{layout:"inline",onFinish:e=>{try{a({...t,...e}),u({...t,...e})}catch(s){}},style:{marginBottom:20},children:[o.jsx(b.Item,{label:"关键词",name:"keyword",children:o.jsx(v,{placeholder:"请输入碎语关键词",allowClear:!0})}),o.jsx(b.Item,{children:o.jsx(w,{type:"primary",htmlType:"submit",style:{marginRight:8},children:"检索"})})]}),o.jsx(N,{...i,rowSelection:h,footer:()=>o.jsxs(o.Fragment,{children:["批量操作 ",o.jsx(O,{checked:s,onChange:e=>n(e=>!e),style:{marginRight:8}}),s&&o.jsx(o.Fragment,{children:o.jsx(j,{title:"Are you sure delete the fragments?",onConfirm:m,okText:"Yes",cancelText:"No",children:o.jsx(w,{type:"danger",size:"small",disabled:0===l.length,children:"批量删除"})})})]})})]})}},Symbol.toStringTag,{value:"Module"}));const gt=Object.freeze(Object.defineProperty({__proto__:null,default:function(e){const[t,a]=d.useState(""),[s,n]=d.useState("panyunyi"),l=parseInt(e.match.params.id);return d.useEffect(()=>{var e;l&&(e=l,Ke.get("/fragment/".concat(e)).then(e=>{a(e.content)}))},[e.match.params]),o.jsxs("div",{className:"admin-edit-article",children:[o.jsx(nt,{value:t,onChange:a}),o.jsx(w,{type:"primary",shape:"circle",size:"large",className:"action-icon",title:l?"更新":"发布",icon:l?o.jsx(ee,{}):o.jsx(te,{}),onClick:()=>{l?Ke.put("/fragment/".concat(l),{content:t,author:s}).then(e=>{h.success("更新成功")}):Ke.post("/fragment/create",{content:t,author:s}).then(e=>{h.success("创建成功")})}}),o.jsx(Z,{target:()=>document.querySelector(".admin-content-wrap")})]})}},Symbol.toStringTag,{value:"Module"}));class pt extends d.Component{constructor(e){super(e),this.state={percent:.25}}render(){const{percent:e}=this.props;var t={percent:e,statistic:{title:{formatter:function(){return"内存利用率"},style:function(e){return{fill:e.percent>.65?"white":"rgba(44,53,66,0.85)"}}},content:{style:function(e){return{fontSize:60,lineHeight:1,fill:e.percent>.65?"white":"rgba(44,53,66,0.85)"}}}},liquidStyle:function(e){var t=e.percent;return{fill:t>.75?"#5B8FF9":"#FAAD14",stroke:t>.75?"#5B8FF9":"#FAAD14"}},color:function(){return"#5B8FF9"}};return o.jsx(ae,{...t,chartRef:e=>e})}}const ft=se.connect(Pe+":1234");const xt=Object.freeze(Object.defineProperty({__proto__:null,default:function(e){var[t,a]=d.useState([]),[s,n]=d.useState(.2),[l,r]=d.useState("#F4664A"),[i,c]=d.useState(.26),[u,m]=d.useState([]);d.useEffect(()=>{f()},[]);var h={percent:s,range:{color:l},indicator:{pointer:{style:{stroke:"#D0D0D0"}},pin:{style:{stroke:"#D0D0D0"}}},axis:{label:{formatter:function(e){return 100*Number(e)}},subTickLine:{count:3}},statistic:{content:{formatter:function(e){var t=e.percent;return"CPU占用率: ".concat((100*t).toFixed(0),"%")}},style:{fontSize:60}},animation:!1},g={data:t,xField:"date",yField:"usage",annotations:[{type:"text",position:["min","median"],content:"中位数",offsetY:-4,style:{textBaseline:"bottom"}},{type:"line",start:["min","median"],end:["max","median"],style:{stroke:"red",lineDash:[2,2]}}]},p={data:u,xField:"date",yField:"usage",annotations:[{type:"text",position:["min","median"],content:"中位数",offsetY:-4,style:{textBaseline:"bottom"}},{type:"line",start:["min","median"],end:["max","median"],style:{stroke:"red",lineDash:[2,2]}}]};const f=()=>{Ke.get("/monitor/start").then(e=>{}),ft.on("systemUpdate",e=>{t=[...t,{usage:parseFloat(e.cpuUsage),date:(new Date).toLocaleString()}],u=[...u,{usage:parseFloat(e.MemUsage),date:(new Date).toLocaleString()}],a(t),m(u),n(parseFloat(e.cpuUsage)),c(parseFloat(e.MemUsage))})};return o.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"80%"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},children:[o.jsx(ne,{...h,chartRef:e=>e}),o.jsx(le,{...g,style:{width:"50%"}})]}),o.jsx("p",{}),o.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},children:[o.jsx(pt,{percent:i}),o.jsx(le,{...p,style:{width:"50%"}})]})]})}},Symbol.toStringTag,{value:"Module"}));export{Oe as A,mt as B,ht as C,Me as D,gt as E,xt as F,Be as G,De as H,Ee as S,ge as T,oe as _,de as a,Je as b,Ce as c,Ue as d,ye as e,je as f,ve as g,pe as h,$e as i,ce as j,xe as k,he as l,be as m,Re as n,Fe as o,Le as p,Ie as q,_e as r,Ke as s,fe as t,ue as u,ze as v,qe as w,He as x,at as y,dt as z};
